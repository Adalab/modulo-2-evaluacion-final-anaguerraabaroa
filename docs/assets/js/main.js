"use strict";const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-btn"),listContainer=document.querySelector(".js-list-container");let shows=[];function getData(){let e=inputElement.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{shows=e,renderData(),listenFavourites()})}function renderData(){let e="";for(let s=0;s<shows.length;s++){let t;e+='<li class="results__list--show"></li>';for(let e=0;e<favShows.length;e++)parseInt(favShows[e].id)===shows[s].show.id&&(t="results__list--favWrapper results__list--favBorder");e+=`<div class="results__list--wrapper js-favourites ${t}" id="${shows[s].show.id}">`,null===shows[s].show.image?e+=`<img src="../assets/images/default_image.jpg"; alt="Imagen de la serie ${shows[s].show.name}" class="results__list--image js-show-image"/>`:e+=`<img src="${shows[s].show.image.medium}" alt="Imagen de la serie ${shows[s].show.name}" class="results__list--image js-show-image" />`,e+=`<h4 class="results__list--title js-show-title">${shows[s].show.name}</h4>`,e+="</div>",e+="</li>"}listContainer.innerHTML=e}btnElement.addEventListener("click",getData);const favouriteList=document.querySelector(".js-favourites-list");let favShows=[],favShowsId=[];function favouriteShows(e){const s=e.currentTarget,t=s.querySelector(".js-show-title"),a=s.querySelector(".js-show-image"),o={name:t.innerHTML,image:a.src,id:s.id},i=parseInt(s.id);favShowsId=favShows.map((function(e){return parseInt(e.id)}));const n=favShowsId.indexOf(i);-1===n?favShows.push(o):favShows.splice(n,1),renderFavShows(),listenRemoveBtn(),renderData(),listenFavourites(),setLocalStorage()}function renderFavShows(){let e="";for(let s=0;s<favShows.length;s++){if(e+='<li class="favourites__list--favshow js-fav-show">',e+='<div class="favourites__list--wrapper">',null===favShows[s].image){e+=`<img src="${"../assets/images/default_image.jpg"}" alt="Imagen de la serie ${favShows[s].name}" class="favourites__list--image"/>`}else e+=`<img src="${favShows[s].image}" alt="Imagen de la serie ${favShows[s].name}" class="favourites__list--image" />`;e+=`<h4 class="favourites__list--title">${favShows[s].name}</h4>`,e+=`<button class="favourites__list--button js-fav-btn"><i class="fas fa-times" id="${favShows[s].id}"></i></button>`,e+="</div>",e+="</li>"}favouriteList.innerHTML=e}function listenFavourites(){const e=document.querySelectorAll(".js-favourites");for(const s of e)s.addEventListener("click",favouriteShows)}function setLocalStorage(){localStorage.setItem("favShows",JSON.stringify(favShows))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favShows"));null!==e&&(favShows=e,renderFavShows(),listenRemoveBtn(),listenFavourites())}const resetBtn=document.querySelector(".js-btn-reset");function handleReset(){favShows=[],inputElement.value="",localStorage.removeItem("favShows"),renderFavShows(),listenRemoveBtn(),renderData(),listenFavourites()}function removeFavShow(e){for(let s=0;s<favShows.length;s++){parseInt(e.target.id)===parseInt(favShows[s].id)&&favShows.splice([s],1)}renderFavShows(),listenRemoveBtn(),renderData(),listenFavourites(),setLocalStorage()}function listenRemoveBtn(){const e=document.querySelectorAll(".js-fav-btn");for(const s of e)s.addEventListener("click",removeFavShow)}resetBtn.addEventListener("click",handleReset),getLocalStorage(),getData();