"use strict";const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-btn"),listContainer=document.querySelector(".js-list-container");let shows=[];function preventDefault(e){"Enter"===e.key&&(e.preventDefault(),getData())}function getData(){let e=inputElement.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{shows=e,renderData(),listenFavourites()})}function renderData(){let e="";for(let t=0;t<shows.length;t++){let s;e+='<li class="results__list--show"></li>';for(let e=0;e<favShows.length;e++)parseInt(favShows[e].id)===shows[t].show.id&&(s="results__list--favWrapper results__list--favBorder");e+=`<div class="results__list--wrapper js-favourites ${s}" id="${shows[t].show.id}">`,null===shows[t].show.image?e+=`<img src="./assets/images/default_image.jpg"; alt="Imagen de la serie ${shows[t].show.name}" class="results__list--image js-show-image"/>`:e+=`<img src="${shows[t].show.image.medium}" alt="Imagen de la serie ${shows[t].show.name}" class="results__list--image js-show-image" />`,e+=`<h4 class="results__list--title js-show-title">${shows[t].show.name}</h4>`,e+="</div>",e+="</li>"}listContainer.innerHTML=e}document.addEventListener("keydown",preventDefault),btnElement.addEventListener("click",getData);const favouriteList=document.querySelector(".js-favourites-list");let favShows=[],favShowsId=[];function favouriteShows(e){const t=e.currentTarget,s=t.querySelector(".js-show-title"),a=t.querySelector(".js-show-image"),o={name:s.innerHTML,image:a.src,id:t.id},n=parseInt(t.id);favShowsId=favShows.map((function(e){return parseInt(e.id)}));const i=favShowsId.indexOf(n);-1===i?favShows.push(o):favShows.splice(i,1),renderFavShows(),listenRemoveBtn(),renderData(),listenFavourites(),setLocalStorage()}function renderFavShows(){let e="";for(let t=0;t<favShows.length;t++){if(e+='<li class="favourites__list--favshow js-fav-show">',e+='<div class="favourites__list--wrapper">',null===favShows[t].image){e+=`<img src="${"./assets/images/default_image.jpg"}" alt="Imagen de la serie ${favShows[t].name}" class="favourites__list--image"/>`}else e+=`<img src="${favShows[t].image}" alt="Imagen de la serie ${favShows[t].name}" class="favourites__list--image" />`;e+=`<h4 class="favourites__list--title">${favShows[t].name}</h4>`,e+=`<button class="favourites__list--button js-fav-btn"><i class="fas fa-times" id="${favShows[t].id}"></i></button>`,e+="</div>",e+="</li>"}favouriteList.innerHTML=e}function listenFavourites(){const e=document.querySelectorAll(".js-favourites");for(const t of e)t.addEventListener("click",favouriteShows)}function setLocalStorage(){localStorage.setItem("favShows",JSON.stringify(favShows))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favShows"));null!==e&&(favShows=e,renderFavShows(),listenRemoveBtn(),listenFavourites())}const resetBtn=document.querySelector(".js-btn-reset");function handleReset(){favShows=[],inputElement.value="",localStorage.removeItem("favShows"),renderFavShows(),listenRemoveBtn(),renderData(),listenFavourites()}function removeFavShow(e){for(let t=0;t<favShows.length;t++){parseInt(e.target.id)===parseInt(favShows[t].id)&&favShows.splice([t],1)}renderFavShows(),listenRemoveBtn(),renderData(),listenFavourites(),setLocalStorage()}function listenRemoveBtn(){const e=document.querySelectorAll(".js-fav-btn");for(const t of e)t.addEventListener("click",removeFavShow)}resetBtn.addEventListener("click",handleReset),getLocalStorage(),getData();